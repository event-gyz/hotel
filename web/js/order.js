define("lib/parseActivityDepositListQConfig",["require","exports","module"],function(e,t,i){function n(e){return String(e||"").replace(/[^\d|,，]/g,"").split(/,|，/).filter(function(e){return e}).map(function(e){return e=e.split("|"),{activityId:e[0],amount:e[1]}})}return n}),define("modals/newcontact",["BaseView","MTModel","MTStore","cMemberService","MTGCommon","cGuiderService","static/lib/env",buildViewTemplatesPath("newcontact.new.html"),buildViewTemplatesPath("newcontact.old.html")],function(e,t,i,n,o,a,r,c,s){r=r["default"];var l=[/^1\d{10}$/,/^[^a-zA-Z\d+=-_,.，。：；;:\/'"‘“·~!@#$%^&*()]{2,15}$/,/^[a-zA-Z]{2,15}([-－\s][a-zA-Z]{2,15})*$/,/^[a-zA-Z\d]{1,20}\@[a-zA-Z\d]{1,20}\.[a-zA-Z]{1,20}$/],d=["请输入正确的中文/英文姓名！","请输入正确的手机号码！","请输入正确的电子邮件！","哎呦~亲，保存失败，请重试哦！"],m=t.EditContact.getInstance(),u=i.MtEditContact.getInstance(),h=i.MtContactInfo.getInstance(),p=e.extend({pageid:"10320607433",hpageid:"10320607432",newcontact:_.template(c),oldcontact:_.template(s),onCreate:function(){var e=this;e.signupId=parseInt(e.getQuery("signupId"))||""},onShow:function(){var e=this;e.setIOSBounce(),e.UID=n.getUserId(),e.conInfo=u.get()||{},e.isNew=0==this.modalData.isnew?!1:!0,e.addTemplate(),e.render(),e.initConInfo(),r.envify()},getModalHeader:function(){var e=this;return r.miniApp().then(function(t){var i,n=0==e.modalData.isnew?"编辑联系人":"新增联系人";return e.modalData.editonly&&(n="填写联系人信息"),t||(i=[{tagname:"done",value:"完成",callback:function(){e.verify()}}]),{title:n,back:!0,view:e,home:!1,events:{returnHandler:function(){e.popViewController()}},right:i}})},addTemplate:function(){var e=this;return e.signupId?void e.$el.html(e.newcontact({signupId:e.signupId,data:e.conInfo})):void e.$el.html(e.oldcontact())},onHide:function(){o.__hideMask()},render:function(){var e=this;e.$ele={name:e.$el.find("#conname"),tel:e.$el.find("#contel"),email:e.signupId?{val:function(){return""}}:e.$el.find("#conemail")}},initConInfo:function(){var e=this,t=e.conInfo;e.isNew||(e.$ele.name.val(t.cNName),e.$ele.tel.val(t.mobilePhone),e.$ele.email.val(t.contactEmail))},showNameRules:function(){var e='<div class="ed-main-box" style="border-radius: 5px;"><h2>联系人填写说明<i class="box-close"></i></h2><p>1、中文姓名中不能包含英文字母</p><p>2、英文姓名填写格式:姓在前,姓和名之间需用"-"或" "隔开,如有中间名则同样需用"-"或" "隔开. 例:Zhang San feng或Zhang-San-Feng.</p></div>';o.__showMask(e,{"click div.ed-main-box":"__hideMask"})},verify:function(){var e,t,i=this,n=i.$ele.tel.val().trim();if(!i.orderId){if(e=i.$ele.name.val().trim(),!e||!l[1].test(e)&&!l[2].test(e))return i.showTip(d[0]);e=e.replace(/\s/g," ")}return n&&l[0].test(n)?i.signupId||(t=i.$ele.email.val().trim(),!t||l[3].test(t))?void(this.modalData.editonly?(h.set({cNName:e,mobilePhone:n,contactEmail:t}),i.modalTop.trigger("mtg:contact:saved-local"),i.popViewController()):i.submit(e,n,t)):i.showTip(d[2]):i.showTip(d[1])},submit:function(e,t,i){if(!this._isSubmitting&&n.isLogin()){var o=this,a=(o.isApp?"A":"H",{UID:"",parameterList:[{Key:"BizType",Value:"MTG"}],commonContact:{cachedSerializedSize:-1,charsetName:"",contactTel:"",countryCode:"",gender:"",iD:0,isDefault:"0",jsonBody:"",mobilePhoneForeign:"Delete_Flag",overseasCountryCode:"Delete_Flag",pk:0,realServiceCode:"",validate:!0}});o.isNew?(a.commonContact.cNName=e,a.commonContact.mobilePhone=t,a.commonContact.contactEmail=i):(o.conInfo.cNName=e,o.conInfo.mobilePhone=t,o.conInfo.contactEmail=i,a.commonContact=o.conInfo),m.setParam(a),this._isSubmitting=!0,Lizard.showLoading(),m.excute(function(e){Lizard.hideLoading(),o._isSubmitting=!1,o.modalOpener.trigger("mtg:contact:saved-server"),o.popViewController()},function(e){Lizard.hideLoading(),o._isSubmitting=!1,o.showTip(d[3])},!0,this)}},showTip:function(e){Lizard.showToast(e)},events:{"click span.edit-del-pop":"showNameRules","click .j-btn-save":function(){this.verify()}}});return p}),define("modals/contacts",["BaseView","MTGCommon","MTModel","MTStore","cMemberService","cGuiderService","static/lib/env","modals/newcontact",buildViewTemplatesPath("contacts.main.html"),buildViewTemplatesPath("contacts.list.html")],function(e,t,i,n,o,a,r,c,s,l){r=r["default"];var d=i.GetContacts.getInstance(),m=n.MtContactInfo.getInstance(),u=n.MtEditContact.getInstance(),h=e.extend({pageid:"10320607431",hpageid:"10320607430",conTmpl:_.template(l),onCreate:function(){var e=this;e.signupId=parseInt(e.getQuery("signupId"))||"",this.on("mtg:contact:saved-server",function(){e.getContacts()})},renderModal:function(){this.$el.html(_.template(s))},onShow:function(){t._login();var e=this;e.conInfo=m.get(),e.getContacts(),r.envify()},getModalHeader:function(){var e=this;return r.miniApp().then(function(t){var i;return t||(i=[{tagname:"newcontact",value:"新增",callback:function(){e.newCon()}}]),{title:"选择联系人",back:!0,view:e,home:!1,right:i,events:{returnHandler:function(){e.popViewController()}}}})},getContacts:function(){if(o.isLogin()){var e=this;d.setParam({UID:"",parameterList:[{Key:"BizType",Value:"MTG"}]}),Lizard.showLoading(),d.excute(function(t){Lizard.hideLoading();var i=t.commonContacts;return i&&i instanceof Array?i.length?(e.$el.find('article[data-list="contacts"]').css("display","block"),e.$el.find('article[data-list="emptytip"]').css("display","none"),e.conArr=i,void e.showContacts(i)):(e.$el.find('article[data-list="contacts"]').css("display","none"),void e.$el.find('article[data-list="emptytip"]').css("display","")):e.errTip()},function(t){Lizard.hideLoading(),e.errTip()},!0,this)}},showContacts:function(e){var t=this;t.conArr.length&&(t.$el.find("#btn_reget").parent().css("display","none"),t.$el.find("ul.contact-main").html(t.conTmpl({conArr:t.conArr,signupId:t.signupId})),t.bingo())},bingo:function(){var e,t=this;_.isEmpty(t.conInfo)||(e=t.$el.find('li[data-pid="'+t.conInfo.iD+'"]'),e&&e.find("i.checkbox").addClass("checkbox-cur"))},errTip:function(){var e=this;e.$el.find("#btn_reget").parent().css("display",""),Lizard.showToast("哎呦~亲，获取联系人信息失败，请重试！")},editContact:function(e){for(var t,i=this,n=$(e.currentTarget),o=n.parent().attr("data-pid"),a=0;a<i.conArr.length;a++)if(i.conArr[a].iD==o){t=i.conArr[a];break}return u.set(t),i.signupId?void this.pushViewController(c,{pristine:!0,modalTitle:"编辑联系人",modalUrl:Lizard.appBaseUrl+"newcontact",modalData:{isnew:0,signupId:i.signupId}}):void this.pushViewController(c,{pristine:!0,modalTitle:"编辑联系人",modalUrl:Lizard.appBaseUrl+"newcontact",modalData:{isnew:0}})},newCon:function(){var e=this;return u.set({}),e.signupId?void this.pushViewController(c,{pristine:!0,modalTitle:"新增联系人",modalUrl:Lizard.appBaseUrl+"newcontact",modalData:{isnew:0,signupId:e.signupId}}):void this.pushViewController(c,{pristine:!0,modalTitle:"新增联系人",modalUrl:Lizard.appBaseUrl+"newcontact",modalData:{isnew:0}})},events:{"click li div.contact-r":"editContact","click li div.contact-l":function(e){for(var t,i=this,n=$(e.currentTarget).closest("li"),o=n.attr("data-pid"),a=0;a<i.conArr.length;a++)if(i.conArr[a].iD==o){t=i.conArr[a];break}i.$el.find("i.checkbox-cur").removeClass("checkbox-cur"),n.find("i.checkbox").addClass("checkbox-cur"),m.set(t),this.modalOpener.trigger("mtg:contact:selected"),this.popViewController()},"click .btn_newcon":"newCon","click #btn_reget":"getContacts"}});return h}),define(["require","exports","module","B2CBaseView","EditCart","MTGCommon","MTModel","BIDModel","MTStore","cMemberService","UILayer","cGuiderService","cUtilCryptBase64","UIToast","UISwitch","cUtilDate","B2CroomModel","B2CroomStore","tools/getQuery","static/lib/miniAppBridge","static/middlewares/navigateTo","lib/parseActivityDepositListQConfig","modals/contacts","modals/newcontact"],function(e,t,i){function n(){}var o=e("B2CBaseView"),a=e("EditCart"),r=e("MTGCommon"),c=e("MTModel"),s=e("BIDModel"),l=e("MTStore"),d=e("cMemberService"),m=e("UILayer"),u=e("cGuiderService"),h=e("cUtilCryptBase64"),p=e("UIToast"),f=e("UISwitch"),g=e("cUtilDate"),v=e("B2CroomModel"),I=c.HotelRoomDetail,y=e("B2CroomStore"),w=e("tools/getQuery"),b=e("static/lib/miniAppBridge")["default"],C=e("static/middlewares/navigateTo")["default"];b.use(C);var T=e("lib/parseActivityDepositListQConfig"),k=e("modals/contacts"),P=e("modals/newcontact"),D=y.Occupant.getInstance(),L=l.MtContactInfo.getInstance(),M=y.B2CBookingStore.getInstance(),R=c.Booking.getInstance(),N=c.OrderCancel.getInstance(),S=[/^1\d{10}$/,/^[^a-zA-Z\d+=-_,.，。：；;:\/'"‘“·~!@#$%^&*()]{2,15}$/,/^[a-zA-Z]{2,15}([-－\s\/][a-zA-Z]{2,15})*$/,/^[a-zA-Z\d]{1,20}@(\.?[\w]{1,20})+$/],x=["哎呦~亲，抱歉，获取订单单号失败，即将返回上一页哦！","哎呦~亲，抱歉，获取订单明细失败，可能是登陆账号与订单号不匹配导致，即将返回上一页哦！","哎呦~亲，抱歉，获取支付流水号失败，请稍后重试哦！","哎呦~亲，抱歉，订单取消失败，请稍后重试哦！"],O=["获取订单明细失败！","请输入正确的联系人中文/英文姓名！","请输入正确的手机号码！","请输入正确的电子邮件！","更多需求请控制在200字以内！","抱歉~亲~下单失败，请重试哦！","商品价格变动","当前仅支持只订团队房时房间总数必须5间及以上，敬请谅解！"],A=[{title:"商品已售完",msg:"抱歉~亲~购物车中部分商品已售完哦!",del:"移除已售完商品"},{title:"商品库存不足",msg:"抱歉~亲~购物车中部分商品的库存不足哦!",del:"移除库存不足商品"},{title:"商品价格变动",msg:"抱歉~亲~购物车中部分商品价格有变动哦!",del:"移除变价商品"}],B=['<div class="fill-box"><h2><%= title %><i class="box-close"></i></h2><div class="fill-bd-box"><p><%= msg %></p></div><div class="fill-btn"><a data-goback="back">返回上一页</a><a style="display:none;"><%= del %></a></div></div>','<div class="fill-box"><h2><%= title %><i class="box-close"></i></h2><div class="fill-bd-box"><p>抱歉~亲，商品价格有变动哦！</p></div><div class="fill-btn"><a data-goback="back">返回上一页</a><a id="continuebooking">继续下单</a></div></div>','<div class="ed-main-box"><h2>联系人填写说明<i class="box-close"></i></h2><p>1、中文姓名中不能包含英文字母</p><p>2、英文姓名填写格式:姓在前,姓和名之间需用"/"隔开,如有中间名则空一格紧随名之后(last/first middle). 例:Zhang/Sanfeng(张三风);Green(姓)/Jim(名) Stephanie(中间名).</p></div>','<div class="fill-box"><h2>下单失败<i class="box-close"></i></h2><div class="fill-bd-box"><p>抱歉~亲，下单失败哦，请联系客服！</p></div><div class="fill-btn"><a href="tel:4009206063">联系客服</a></div></div>','<div class="fill-box"><h2>下单失败<i class="box-close"></i></h2><div class="fill-bd-box"><p>当前时间已过18:00，不能预定次日订单!</p></div><div class="fill-btn"><a href="tel:4009206063">联系客服</a></div></div>','<div class="order-box" style="width:280px;"><h2 class="df a-i-c bor-bottom"><b>温馨提示：</b>您已预订过相同行程的订单</h2><div class="order-box-list"><p><%= hname %><% if(pay){ %><i style="color:red;">(已支付)</i><% } %></p><% if(o){ %><p><%= o.StartDate %>&nbsp;至&nbsp;<%= o.EndDate %></p><p><%= o.str %></p><% } %><span data-checkoid="<%= oid %>">去查看 &gt;</span></div><div class="order-box-btn bor-top"><% if(!pay){ %><p class="df"><span class="fx1 lt js_repeat_cancel">取消预订</span><span class="fx1 rt js_repeat_booking" data-oid="<%= oid %>">继续预订</span></p><span>将取消原订单</span><% } %></div></div>'],z=o.extend({pageid:"600005845",hpageid:"10320604115",OccupantModule:_.template(Lizard.T("Occupant")),cartModule:_.template(Lizard.T("J_cart")),priceSumTmpl:_.template(Lizard.T("J_price")),noticeTmpl:_.template(Lizard.T("J_notice")),couponTmpl:_.template(Lizard.T("couponTmpl")),overtimeTmpl:_.template(Lizard.T("J_overtime")),bedtype:Lizard.T("bedtype"),showToast:function(e){e&&(this._uiToast||(this._uiToast=new p({hideSec:2500})),this._uiToast.datamodel={content:e},this._uiToast.refresh(),this._uiToast.show())},onAppear:function(){this.comPage(),this.initInvoiceInfo(),this.updatePrice()},onCreate:function(){this.hideWxShare();var e=this;e.conname=this.$el.find("#conname"),e.contel=this.$el.find("#contel"),e.conemail=this.$el.find("#conemail"),e.invtit=this.$el.find("#invtit"),e.conemail=this.$el.find(".tap.lh"),e.textarea=this.$el.find("textarea"),e.SimplayLayer=_.inherit(m,{propertys:function($super){$super(),this.addEvents({'click a[data-goback="back"]':function(){this.hide(),e.isApp?u.backToLastPage():Lizard.goTo(e.fromPage?e.fromPage:Lizard.appBaseUrl+"index")},"click div.ed-main-box":function(){this.hide()},"click #continuebooking":function(){this.hide(),e.verifyContactInfo()},"click i.box-close":function(){this.hide()},"click .js_repeat_cancel":function(){this.hide()},"click span[data-checkoid]":function(e){var t=$(e.currentTarget).attr("data-checkoid");t&&(this.hide(),this.jumpPage("myorderdetail?orderId="+t+"&from="+encodeURIComponent(window.location.href)))},"click .js_repeat_booking":function(t){var i=$(t.currentTarget).attr("data-oid");i&&e.keepBookingRep(i)}})},setDatamodel:function(e,t){this.template=e,t&&(this.datamodel=t),this.refresh()},initialize:function($super,e){$super(e)}}),e.render(),e.fromPage=Lizard.P("from")},comPage:function(){var e=this;this.on("mtg:contact:selected",function(){e.initContactInfo(!1,!0)}),this.on("mtg:contact:saved-local",function(){e.initContactInfo(!1,!0)})},onShow:function(){this.comPage(),this.checkDepositStatus(),this.paramPinyin=Lizard.P("activitypinyin");var e=this;e.setIOSBounce(),e.conInfo=L.get()||{},e.cartList=M.get()||[],e.renderOrder(),e.normalizeCartList(),e.cartList.length||(e.showToast("亲，您的购物车是空的哦！"),M.set([])),e.HotelId=e.cartList[0]&&e.cartList[0].MasterHotelId,e.header.set({title:"填写订单信息",back:!0,view:e,home:!1,events:{returnHandler:function(){function t(){e.fromPage?e.isApp?u.backToLastPage():Lizard.goTo(e.fromPage):e.isApp?u.backToLastPage():Lizard.goTo(Lizard.appBaseUrl+"index")}function i(){for(var t="",i=e.$el.find(".Occupant").find("input"),n=0;n<i.length;n++)i[n].value&&(t+=i[n].value.trim()+",");return t}$(".alert__layer--wrap").addClass("hidden"),(e.conname.val()||"").length>0||(e.contel.val()||"").length>0||(e.conemail.val()||"").length>0||(e.invtit.val()||"").length>0||(e.conemail.val()||"").length>0||(e.textarea.val()||"").length>0||(i()||"").length>0?e.showConfirm({datamodel:{content:"确认离开此页吗？"},okAction:function(){this.hide(),D.set(null),t()}}):t()}}}),e.header.show(),e.setServerTime(),Lizard.showLoading(),e.initPage(),e._conInited||(e.initContactInfo(!0),e._conInited=!0),e.initInvoiceInfo(),e.updatePrice(),this.needDeposit?(this.$(".j-mod--invoice").addClass("hidden"),this.$(".shop-pay--b2croom").html("支付定金"),this.$("#conname").attr("placeholder","请填写您的姓名与PIN码")):(this.$(".j-mod--invoice").removeClass("hidden"),this.$(".shop-pay--b2croom").html("去支付"),this.$("#conname").attr("placeholder","姓名")),e.$eles.cartDiv.closest("article.mt-order-bg").show(),e.$el.find("#pricesum").parent().show(),e.$el.find("#ord_loading").hide(),Lizard.hideLoading(),/^user_addrs|contacts$/.test(this.lastViewId)&&setTimeout(function(){e.restoreScrollPos()},0),e.getRms();try{e.checkLogin(e.verifyStock.bind(e))}catch(t){if(!(t instanceof n))throw t}this.getActivityDetail().then(this.verifyDateUsage.bind(this)).then(this.getTipsAndCancelPolicy.bind(this))["catch"](function(e){if(!(e instanceof n))throw e}),Lizard.isIPhoneX&&this.$(".shop-list--order").addClass("iphoneX")},renderOrder:function(){var e,t,i=this,n=i.cartList[0],o=0;for(e=0;e<n.room.length;e++)o+=n.room[e].num;var a=D.get()||[],r=[];for(e=0;e<Number(o);e++)r.push({id:e+1,name:""});if(a)if(a.length>Number(o))for(t=0;t<Number(o);t++)r[t].name=a[t].name;else for(t=0;t<a.length;t++)r[t].name=a[t].name;i.roomNum=parseInt(o),i.$el.find(".Occupant").html(i.OccupantModule({data:r,helper:this.templateHelper}))},checkDepositStatus:function(){var e=T($("#qcfg-activity_deposit_list").html()),t=w("activityid"),i=_.findWhere(e,{activityId:t});i&&(this.needDeposit=!0,this.depositAmount=i.amount,S[1]=/^[^a-zA-Z\d+=-_,.，。：；;:\/'"‘“·~!@#$%^&*()]{2,15}(\d{3,})?$/)},normalizeCartList:function(){var e=this,t=this.cartList,i=this.depositAmount;if(this.needDeposit){_.each(t[0].room,function(t){null==t._totalPrice&&(t._totalPrice=e.templateHelper.getPriceSum(t))});try{_.each(t[0].room,function(e){_.each(e.PriceFrame,function(e){_.each(e.PriceEntity,function(e){e.Price=i,_.each(e.PriceCanlendar,function(e){e.Price=i})})})})}catch(n){}this.saveCartChange(t)}},getCurrentActivityId:function(){return Number(Lizard.P("activityid"))},getRms:function(){var e=this;window.__rmsbfi=window.__rmsbfi||[],window.__rmsbfi.push(["_getRmsToken",function(t){e.rmsToken=t}])},renDisList:function(e){if(!e||!e.length)return[];var t,i=-1,n=[],o=[],a=0,r=0;return e.forEach(function(e,t){return r+=e.Amount,e.o=t+1,e.IsCurrent&&e.RealGet<=0?(i=t,e.RealGet<=0&&(a=e.Amount)):e.RealGet>0?n.push(e):e.RealGet<=0?o.push(e):void 0}),t=n.concat(-1==i?[]:[e[i]]).concat(o),-1==i?(i=0,t.pay=0):(i=n.length,t.pay=1),t.forEach(function(t,n){n==i-1||i==n||n==i+1||!i&&2==n||i==e.length-1&&n==i-2?t.show=1:t.show=0}),t.m=a?a:0,t.t=r?r:0,t},initBedt:function(e){var t=this;t.$(e?"#gangaobed":"#neidibed").remove(),t.bedtToggle=new f({wrapper:t.$("#bedt .j-mtg-bedt-toggle"),changed:function(e){t.$("#bedt .right-box span").html(e?"需要":"无"),t.$("#bedt .detail-date-select").css("display",e?"":"none")}}),t.bedtToggle.show()},initMoreReq:function(){var e=this;e.moreReqToggle||(e.moreReqToggle=new f({wrapper:e.$("#morereq .j-mtg-morereq-toggle"),changed:function(t){e.$("#morereq .right-box span").html(t?"有":"无"),e.$("#morereq div.checkbox-p").css("display",t?"":"none")}}),e.moreReqToggle.show())},onHide:function(){var e=this,t=c.AddRiskControl.getInstance();e.layer&&e.layer.hide(),r.__hideMask(),e.$el.find("#pricesum").parent().css("display",""),window.onresize=null,this.saveScrollPos(),clearInterval(e.timeInterval);try{t.abort()}catch(i){}Lizard.hideConfirm(),this.xhrGetActivityDetail&&this.xhrGetActivityDetail.abort(),this.xhrVerifyStock&&this.xhrVerifyStock.abort(),this._uiToast&&this._uiToast.hide(),this.isOccupant&&1==this.isOccupant||this.resiveOccupant()},setCurCoupon:function(){},setServerTime:function(){var e=this;e.serverTimeMil=parseInt($("#ord_loading").attr("data-servertime")),e.timeInterval=setInterval(function(){e.serverTimeMil+=1e3},1e3)},render:function(){var e=this;e.$eles={conName:e.$el.find("#conname"),conTel:e.$el.find("#contel"),conEmail:e.$el.find("#conemail"),moreReq:e.$el.find("textarea"),cartDiv:e.$el.find("#cart"),ul:e.$el.find("#coupons"),invTit:e.$el.find("#invtit"),ideCode:e.$el.find("#idecode"),ideSpe:e.$el.find("dd.fill-billInfo i")}},initPage:function(){var e=this;e.priObj={totPrice:0},e.cartList[0]?(e.getMinMaxNum(),e.$eles.cartDiv.removeClass("active"),e.$eles.cartDiv.html(e.cartModule({data:e.cartList[0],helper:this.templateHelper,needDeposit:e.needDeposit})),e.$el.find("div.js_tip").css("display",e.cartList[0].room&&e.cartList[0].room.length?"":"none"),e.firstNewCart=1,e.cartObj=new a("#cart",e),e.firstNewCart=0,e.initMoreReq()):e.$el.find("#pricesum .shop-pay--b2croom").addClass("bg-gray"),e.$el.find("#pricesum").html(e.priceSumTmpl({data:e.priObj})),e.$eles.cded=e.$el.find("#couponded"),setTimeout(function(){e.loadMore()},0)},loadMore:function(){if(document.getElementsByClassName("L-signupRemark")[0]){var e=document.getElementsByClassName("L-signupRemark")[0].getClientRects(),t=[],i=[],n=[];for(o in e)t.push(e[o].top);for(var o=0;o<t.length;o++)t[o]&&i.push(t[o]);for(var a=0;a<i.length;a++){for(var r=0,c=0;c<n.length;c++)i[a]==n[c]&&r++;0==r&&n.push(i[a])}n.length>1&&$(".L-signupRemark").addClass("warp")}},templateHelper:{isLoggedIn:function(){return d.isLogin()},formatDate:function(e){e=e.split("-");var t=e[1],i=e[2];return t+"月"+i+"日"},getBreakfastDesc:function(e){return["无早","单早","双早","三早","四早","五早","六早","七早","八早","九早"][e.Breakfast]},getPriceAvg:function(e){return Math.floor(_.findWhere(e.PriceFrame[e.Breakfast].PriceEntity,{RoomID:e.RoomId,RoomBedTypeCode:e.RoomBedTypeCode}).Price)},getPriceSum:function(e){var t=_.findWhere(e.PriceFrame[e.Breakfast].PriceEntity,{RoomID:e.RoomId,RoomBedTypeCode:e.RoomBedTypeCode}).PriceCanlendar,i=_.reduce(t,function(e,t){return e+Number(t.Price)},0);return Math.floor(i*e.num)}},parseDate:function(e){var t=new Date(parseInt(e.replace(/(^[^\d]*)|(\+.*$)/g,"")));return t.getFullYear()+"."+(t.getMonth()+1)+"."+t.getDate()},getCoupons:function(e){},noCoupons:function(){},countForCoupons:function(){},convertToUTCDate:function(e){return e=e.replace(/-/g,"/"),"/Date("+new Date(e).getTime()+"+0800)/"},getMinMaxNum:function(){var e,t=this,i=0,n=[];_.each(t.cartList,function(t,o){_.each(t.room,function(t,i){if((5==t.RoomBedTypeCode||0==t.RoomBedTypeCode)&&(e=1),!t.num||void 0===t.tmpBreakfastType){var n,o,a,r,c=[],s=[];t.tmpBfkMinNum={};for(var l in t.PriceFrame)n="tmpBfk"+l+"MinNum",o="tmpBfk"+l+"MaxNum",_.each(t.PriceFrame[l].PriceEntity,function(e,t){!t&&(a=e.RoomMin)&&(r=e.RoomMax),a>e.RoomMin&&(a=e.RoomMin),r<e.RoomMax&&(r=e.RoomMax)}),t.tmpBfkMinNum[n]=a,t.tmpBfkMinNum[o]=r,t.num>=a&&t.num<=r&&c.push(l),s.push(l);t.tmpBreakfastType=t.Breakfast}}),i+=t.room?t.room.length:0,_.each(t.meeting,function(e,t){return-1==n.indexOf(e.MeetingRoomID)?(e.hideMeetingRoomName=0,n.push(e.MeetingRoomID)):void(e.hideMeetingRoomName=1)})}),t.$("#bedt").html(t.bedtype),i&&e?(t.$("#bedt").css("display",""),t.initBedt(-1==[58,59,617,720,3845,3847,3848,3849,5152,5589,6954,7203,7523,7524,7570,7614,7662,7805,7808,7809,7810,7811].indexOf(t.cartList[0].CityId))):t.$("#bedt").css("display","none")},initNoticeTmpl:function(){return this.noticeTmpl({data:this.tipsAndCancelPolicyData})},setBookingParams:function(e){var t=this,i=0;t.rArr=[],t.mArr=[],_.each(t.cartList,function(e,n){e.room&&e.room.length&&_.each(e.room,function(e,n){var o=t.templateHelper.getPriceAvg(e);i+=t.templateHelper.getPriceSum(e),t.rArr.push({RoomId:e.RoomId,TeamRoomType:e.TeamRoomType,RoomName:e.SubTitle?e.SubTitle:e.BaseRoomName,RoomBedTypeCode:e.RoomBedTypeCode,PaymentType:e.PayType,UseDate:{StartDate:e.inDate,EndDate:e.outDate},Quantity:e.num,HotelPrice:{Price:o,PrePayPrice:0},HotelID:e.HotelID,MasterHotelID:e.MasterHotelID,HotelCityID:e.HotelCityID})}),e.meeting&&e.meeting.length&&_.each(e.meeting,function(e,n){var o=parseInt(e.Price)*parseInt(e.num);i+=o,t.setMetProlist({ProductId:e.ProductId,UseDate:e.date,MeetingRoomResId:e.MeetingRoomID,Clock:e.timepart,Price:e.Price})})}),t.priObj={totPrice:i},t.$el.find("#pricesum a")[0>=i?"addClass":"removeClass"]("bg-gray"),t.saveCartChange(t.cartList),t.firstNewCart?t.updatePrice():t.countForCoupons()},setMetProlist:function(e){var t=this,i=[];i=_.filter(t.mArr,function(t){return t.ProductId==e.ProductId&&t.MeetingRoomInfos[0].MeetingRoomResId==e.MeetingRoomResId?(t.MeetingRoomInfos[0].UseDates.push({Date:e.UseDate,Clock:e.Clock,Price:e.Price}),!0):void 0}),i.length||t.mArr.push({ProductId:e.ProductId,Quantity:1,MeetingRoomInfos:[{MeetingRoomResId:e.MeetingRoomResId,UseDates:[{Date:e.UseDate,Price:e.Price,Clock:e.Clock}]}]})},initContactInfo:function(e,t){if(e||t){this.conInfo=L.get()||{};var i=this,n=i.conInfo.cNName;_.isEmpty(i.conInfo)||(i.$eles.conName.val(n||""),i.$eles.conTel.val(i.conInfo.mobilePhone||""),i.$eles.conEmail.val(i.conInfo.contactEmail||""))}},checkLogin:function(e){_.isFunction(e)||(e=function(){}),d.isLogin()||d.isNonUser()?e():this.showLoginPopup(e)},showLoginPopup:function(e){function t(){e(),Lizard.hideLoading(),i.$(".g-login-info").addClass("hidden")}var i=this;_.isFunction(e)||(e=function(){});var n;n="miniprogram"==window.__wxjs_environment?[{name:"去登录",className:"cui-btns-ok"}]:[{name:"非会员预订",className:"cui-btns-cancel"},{name:"去登录",className:"cui-btns-ok"}],Lizard.showConfirm({datamodel:{content:"登录后预订，查询订单更便捷。",btns:n},maskToHide:!0,cancelAction:function(){this.hide(),Lizard.showLoading(),"miniprogram"==window.__wxjs_environment?b("navigateTo",{url:"/pages/login/login?data="+encodeURIComponent(JSON.stringify({url:location.href}))}):d.nonMemberLogin({callback:function(){location.replace(location.href)}})},okAction:function(){this.hide(),r._login({callback:t})}})},verifyRoomTotalNums:function(){this.verifyContactInfo()},verifyOccupant:function(){for(var e=this,t=0,i="",n=e.$el.find(".Occupant").find("input"),o=0;o<n.length;o++){if(!n[o].value.trim())return t++,void e.showTip("请填写住客"+(o+1)+"的姓名");i+=n[o].value.trim()+","}t>0&&(e.OccupantVerify=1),e.OccupantName=i.substr(0,i.length-1)},verifyContactInfo:function(){if(this.verifyOccupant(),(!this.OccupantVerify||1!=this.OccupantVerify)&&this.OccupantName){var e,t=this,i="",n=t.$eles.conName.val().trim(),o=t.$eles.conTel.val().trim(),a=t.$eles.conEmail.val().trim(),r="",c=t.$eles.moreReq.val().trim(),s={Name_CH:"",Name_EN:""};if(e=t.$("#morereq .j-mtg-morereq-toggle div.cui-switch.current").length&&t.$('#morereq p[data-type="3"].active').length,!n)return t.showTip(O[1]);if(!o||!S[0].test(o))return t.showTip(O[2]);if(a&&!S[3].test(a))return t.showTip(O[3]);if(e&&c.length>200)return t.showTip(O[4]);if(S[1].test(n))s.Name_CH=n;else{if(!S[2].test(n))return t.showTip(O[1]);s.Name_EN=n}t.conInfo.cNName=n,s.tel=o,s.email=a,c=e?c.replace(/\s/g,""):"",t.$("#morereq .checkbox-p p.active").each(function(e,t){var i=$(t).attr("data-type"),n=$(t).html();3!=i&&(r+=n+",")}),(r||c)&&(r=String(r)+c),r=r.replace(/,$/,""),t.$("#bedt .j-mtg-bedt-toggle div.cui-switch.current").length&&(i=t.$("#bedt span.pitch"),i=i.length?(r?"|":"")+"床型偏好:"+i.html().trim():""),t.$("#morereq .j-mtg-morereq-toggle .current").length||i||(r="无"),s.moreReq=r+i,t.conInfo.mobilePhone=o,t.conInfo.contactEmail=a,L.set(t.conInfo),t.Booking(s)}},getTipsAndCancelPolicy:function(e){function t(){i.showTip("获取退改政策失败")}var i=this;try{e.isSuccessful?i.tipsAndCancelPolicyData=e.activityInfo.activityRule:t()}catch(n){t()}},verifyStock:function(){function e(){throw i.openStockEmptyPopup(),new n}var t,i=this;try{t=this.cartList[0].room[0]}catch(o){return Promise.resolve()}return new Promise(function(o,a){var r=new I;i.xhrVerifyStock=r,r.setParam({IdType:1,MeetingPlaceId:t.MasterHotelID,CheckInDate:t.inDate,CheckOutDate:t.outDate,RequestHead:{Version:4},ActivityID:Lizard.P("activityid"),Channel:"Html5"}),r.excute(function(a){var r,c;try{if(_.each(a.HotelRoomList,function(e){var i;c||(i=_.findWhere(e.HotelRoomEntityV2,{Breakfast:t.Breakfast}),i&&(c=_.findWhere(i.PinFangPriceEntity,{RoomID:t.RoomId,RoomBedTypeCode:t.RoomBedTypeCode})))}),c||e(),r=_.some(c.PriceCanlendar,function(e){return e.SurplusQuantity<=0?!0:void 0}),r||c.SurplusQuantity<=0)throw i.openStockEmptyPopup(),new n;o()}catch(s){if(s instanceof n)throw s;e()}},e)})},verifyDateUsage:function(e){if(this.hasOverdueItem()||this.isActivityOverdue(e.activityInfo))throw this.showDateInvalidModal(),new n;return e},hasOverdueItem:function(){var e=this,t=e.serverTimeMil?new Date(e.serverTimeMil):new Date,i=t.getTime(),n=t.getHours()>=18;return e.overtimeGoods=[],_.each(e.cartList||[],function(t,o){t.room&&t.room.length&&_.each(t.room,function(t,o){var a=new Date(t.inDate).getTime(),r=(a-i)/864e5;(-1>r||n&&1>=r)&&e.overtimeGoods.push({jsId:t.jsId,name:t.BaseRoomName+t.RoomBedType})})}),e.overtimeGoods.length>0},isActivityOverdue:function(e){var t=g.getServerDate(),i=new Date(e.bookEndDate);return t>=i},getActivityDetail:function(){var e=this;return new Promise(function(t,i){var n=v.getActivityDetail.getInstance();n.setParam({isShowAllModule:!0,activityPinYin:Lizard.P("activitypinyin")||Lizard.P("activityname")}),n.excute(t,i),e.xhrGetActivityDetail=n})},showDateInvalidModal:function(){var e=this;Lizard.showConfirm({datamodel:{content:"抱歉，您选择的日期当前不可预订",btns:[{name:"重新选择日期",className:"cui-btns-ok"}]},maskToHide:!1,okAction:function(){e.isApp?u.backToLastPage():Lizard.goBack()}})},openStockEmptyPopup:function(){Lizard.showConfirm({datamodel:{content:"抱歉，您选择的酒店房型库存不足，立即返回重新选择酒店",btns:[{name:"重新选择酒店",className:"cui-btns-ok"}]},maskToHide:!0,okAction:function(){this.hide(),Lizard.jump(Lizard.appBaseUrl+"b2croom/"+(Lizard.P("activitypinyin")||Lizard.P("activityname"))+"/list?backtohome=true")}})},Booking:function(e){var t,i,o=this,a=JSON.parse(localStorage.getItem("UNION")||"{}");(!a.data||a.st&&(new Date).getTime()>a.st)&&(a.data={});var r=Lizard.getMarketInfo();r&&(r.awake_allianceid&&(a.data.awake_allianceid=r.awake_allianceid),r.awake_sid&&(a.data.awake_sid=r.awake_sid),r.awake_ouid&&(a.data.awake_ouid=r.awake_ouid),r.awake_sourceid&&(a.data.awake_sourceid=r.awake_sourceid),r.awake_time&&(a.data.awake_time=r.awake_time)),Lizard.showLoading();var s,l=this,d=[{Name_CH:e.Name_CH,Name_EN:e.Name_EN,ContactPersonType:[{ContactType:"Phone",Number:e.tel},{ContactType:"Mail",Number:e.email}]}],m={Price:l.priObj.totPrice,PrePayPrice:0},u={HotelMeetingOrderEntity:l.mArr,HotelOrderEntity:l.rArr};try{l.needDeposit&&(m.Price=0,_.each(l.cartList[0].room,function(e){_.isFinite(e._totalPrice)&&(m.Price+=e._totalPrice)}))}catch(h){}s={ContactPersons:d,Price:m,ProductList:u,ExRequirement:e.moreReq,OrderType:40,DistributionChannel:{ChannelType:l.isApp?1:3,SourceUrl:window.location.href,ActivityID:this.getCurrentActivityId()},DistributionInfo:a.data},l.curCoupon&&(s.DiscountCoupon={DisCouponCode:l.curCoupon.couponCode,Price:l.curCoupon.maxDeduction}),R.param={},R.setParam(s);try{}catch(h){}t=i?Promise.resolve(i):R.fetch(),this.Q().then(this.getActivityDetail.bind(this)).then(this.verifyDateUsage.bind(this)).then(this.verifyStock.bind(this)).then(function(){return t}).then(this.handleBookingResult.bind(this)).then(function(e){var t=l.getInvoiceInfo();return null!=t&&1==t.isNeed&&l.saveInvoiceInfo(e,t),e}).then(this.getDetail.bind(this)).then(function(e){var t=c.CheckinPerson.getInstance(),i=o.OccupantName,n=[{SubOrderID:o.SubOrderID,PersonList:i}];return t.setParam({OrderId:o.orderId,RoomList:n}),new Promise(function(i,n){t.execute(function(t){i(e)},function(e){Lizard.showToast("保存入住人信息失败，请重试！")},!0,this)})}).then(this.checkSM.bind(this)).then(this.getRequestId.bind(this)).then(this.setUrlParams.bind(this))["catch"](function(e){Lizard.hideLoading(),e instanceof n||l.showTip(O[5])})},Q:function(){return Promise.resolve()},handleBookingResult:function(e){var t=this,i=!1,o=!1;if(t.layer||(t.layer=new t.SimplayLayer),e.WarningsType instanceof Array&&_.each(e.WarningsType,function(e,n){730205099==e.Code&&(t.priObj.totPrice=parseInt(e.ShortText),i=!0),730205200==e.Code&&(t.priObj.prePrice=parseInt(e.ShortText),i=!0),730205094==e.Code&&(o=!0)}),e.IsSuccess){if(!e.WarningsType.length&&!e.ErrorsType.length&&e.OmdOrderId&&0!=e.OmdOrderId)return this.attachOrderInfo(e),t.orderId=e.OmdOrderId,e.OmdOrderId}else if(i)t.updatePrice(),t.layer.setDatamodel(B[1],{title:O[6]});else if(o)t.layer.setDatamodel(B[0],A[1]);else if(e.ErrorsType&&e.ErrorsType[0]){if(730205400==e.ErrorsType[0].Code&&t.layer.setDatamodel(B[4]),730205402!=e.ErrorsType[0].Code&&730205403!=e.ErrorsType[0].Code){t.showTip(O[5]);try{}catch(a){}throw new n}var r=t.$("#cart dt h4 span").html(),c=e.ErrorsType[0].ShortText;c?(c=JSON.parse(c),c.StartDate=c.StartDate.match(/[^\s]*/)[0],c.EndDate=c.EndDate.match(/[^\s]*/)[0],t.$('dd[data-jsid][data-type="room"]').each(function(e,t){e=$(t).attr("data-jsid");var i=$(t).find("h5").text();-1!=e.indexOf(c.RoomID)&&(i=i.replace(/\/(\s+)/g,"$1").replace(/\s+/,"  "),c.str=i+"  "+c.Quantity+"间")})):c="",t.layer.setDatamodel(B[5],{hname:r,pay:730205402==e.ErrorsType[0].Code?0:1,oid:c?c.OrderId:"",o:c})}else t.layer.setDatamodel(B[3]);throw t.layer.show(),new n},attachOrderInfo:function(e){var t=this.cartList;try{t[0].__order_info__||(t[0].__order_info__=e),this.saveCartChange(t)}catch(i){}},getDetail:function(e){var t=Lizard.P("allianceid"),i=c.MyOrderDetail.getInstance(),o=this,a={OrderId:e,SourceType:"MobileApp",AllianceID:t,QueryType:"Member",NonEncryptMask:!1};return i.setParam(a),i.fetch().then(function(e){var t=e.OrderInfo.MobileOrderBasicInfo||{},i=o.renDisList(e.OrderInfo.MobileDivPaymentInfoList);if(!e||!e.OrderInfo)throw o.showToast(x[1]),new n;o.amount=i.length&&i.m&&i.pay?i.m:t.WaitingForPaymentAmount,o.MobileOrderBasicInfo=e.OrderInfo.MobileOrderBasicInfo;try{o.SubOrderID=e.OrderInfo.MobileHotelListInfo[0].SubOrderID}catch(a){return e.OrderInfo.MobileOrderBasicInfo}return e.OrderInfo.MobileOrderBasicInfo},function(e){throw o.showToast(x[1]),new n})},checkSM:function(e){var t=this,i=t.MobileOrderBasicInfo;if(!e.PaymentSwitch||i.WaitingForPaymentAmount!=e.WaitingForPaymentAmount)throw t.showToast(e.PaymentSwitch?"订单金额已发生变化，将为您刷新！":"订单处理中，请稍后！"),new n},getRequestId:function(){var e=this,t=c.GetRequestId.getInstance();try{e.postRiskControlData()}catch(i){}return t.setParam(),t.fetch().then(function(t){if(!t||!t.ReferenceID)throw e.showToast(x[2]),new n;return t.ReferenceID},function(t){throw e.showToast(x[2]),new n})},postRiskControlData:function(){var e=c.AddRiskControl.getInstance(),t=this,i=localStorage.CINFO,n={orderId:t.orderId,Source:t.isApp?"APP":"H5"};t.isApp?"string"==typeof i&&(n.ClientID=JSON.parse(i).clientID):t.rmsToken&&(n.RmsToken=encodeURIComponent(t.rmsToken)),
e.setParam(n),e.execute(function(e){},function(e){},!0,this),setTimeout(function(){e.abort()},1e3)},setUrlParams:function(e){var t,i,n,o,a,r,s=c.MyOrderDetail.getInstance(),l=s.baseurl().h5Finance,d=this.cartList,m=d[0].MeetingPlaceName,p=this,f=2019,g=window.location.href,v=window.location.protocol+"//"+window.location.host+"/webapp/meeting/";return t={oid:parseInt(p.orderId),bustype:f,requestid:e,islogin:0,from:g,sback:v+"myorderdetail",eback:v+"payfail",title:m,subtitle:"请在30分钟内完成支付，否则订单会自动取消",amount:p.amount,currency:"CNY",needInvoice:!1},i={isRealTimePay:1,isAutoApplyBill:1,isIntegralGurantee:0,weixinorgin:0},window.isMiniApp&&(i.payTypeList=4,i.subPayTypeList=256),a=JSON.stringify(t),r=JSON.stringify(i),n=h.Base64.encode(a),o=h.Base64.encode(r),p.urlParams="index.html#index?oid="+p.orderId+"&bustype="+l.merchantNo+"&token="+encodeURIComponent(n)+"&extend="+encodeURIComponent(o),p.isApp?(Lizard.hideLoading(),u.pay.callPay({path:"payment2",param:p.urlParams})):void("miniprogram"==window.__wxjs_environment?b("navigateTo",{url:"/pages/pay-gateway/pay-gateway?data="+encodeURIComponent(JSON.stringify({oid:parseInt(p.orderId),bustype:f,token:t,extend:i}))}):p.h5Pay(a,r,n,o,f))},h5Pay:function(e,t,i,n,o){var a=this,r=s.GetPaySignature.getInstance();r.setParam({Token:e,Extend:t}),r.excute(function(e){if(!e||!e.isSuccess||!e.signature)return a.showToast("抱歉~亲，获取支付签名认证失败，请您稍后再试！");e=e.signature;var t=a.$el.find("#h5PostPay");t.find('[name="oid"]').val(parseInt(a.orderId)),t.find('[name="bustype"]').val(o),t.find('[name="token"]').val(i),t.find('[name="extend"]').val(n),t.find('[name="sign"]').val(e),t.submit()},function(e){Lizard.hideLoading(),a.showToast("抱歉~亲，获取支付签名认证失败，请您稍后再试！")},!0,this)},initInvoiceInfo:function(){var e=this.getInvoiceInfo();null!=e&&1==e.isNeed?this.$(".j-invoice__status").html("需要"):this.$(".j-invoice__status").html("不需要")},getInvoiceInfo:function(){var e=y.InvoiceInfo.getInstance();return e.get()},clearInvoiceInfo:function(){var e=y.InvoiceInfo.getInstance();e.set(null)},getInvoiceResType:function(){var e=0;return _.each(this.cartList,function(t){t.room&&t.room.length>0&&(e|=1),t.meeting&&t.meeting.length>0&&(e|=2)}),e},saveInvoiceInfo:function(e,t){var i=this,n=new c.SetOrderInvoiceInfo,o=(new Date).toLocaleDateString();try{var a={InvoiceInfo:{OrderID:e,TransType:0,Title:t.Title,InvoiceDetails:t.InvoiceDetails,ContactName:t.ContactName,Address:t.Address,Mobile:t.Mobile,EID:"H5",IsInvoiced:3==t.InvoiceMode?4:1,Amount:Number(i.priObj.totPrice),ProvinceName:t.ProvinceName,CityName:t.CityName,LocationName:t.LocationName,OrgFlag:t.OrgFlag,TaxpayerIdentifier:t.TaxpayerIdentifier,InvoiceMode:Number(t.InvoiceMode),InvoiceRequest:1,ProcessType:1,ProcessDate:o,NoteFlag:Number(t.NoteFlag)}};3==t.InvoiceMode&&(a.InvoiceInfo.Email=t.Email||"");for(var r in a.InvoiceInfo)"string"==typeof a.InvoiceInfo[r]&&(a.InvoiceInfo[r]=a.InvoiceInfo[r].replace(/\s/g,"")),void 0===a.InvoiceInfo[r]&&delete a.InvoiceInfo[r];n.setParam(a),n.execute(function(){i.clearInvoiceInfo()},function(){i.clearInvoiceInfo()})}catch(s){i.clearInvoiceInfo()}},updatePrice:function(){var e,t=this.getInvoiceInfo(),i=this,n=i.curCoupon&&i.curCoupon.maxDeduction,o=0;null!=t&&1==t.InvoiceMode&&(o=10),e=i.priObj.totPrice+o,i.$eles.cded&&i.$eles.cded.css("display",n?"":"none"),e-=n||0,e=0>e?0:e,i.$el.find("#pricesum .j-tot-price").html(e)},showTip:function(e){this.showToast(e)},saveCartChange:function(e){M.set(e)},keepBookingRep:function(e){var t=this;Lizard.showLoading(),N.setParam({orderID:e,CancelReason:"取消之前重复的订单继续下新的单子"}),N.excute(function(e){return e.IsSuccess?t.verifyContactInfo():(Lizard.hideLoading(),void t.showToast("取消原订单失败，请稍后重试或者修改当前购物车然后再下单！"))},function(e){Lizard.hideLoading(),t.showToast("取消原订单失败，请稍后重试或者修改当前购物车然后再下单！")},!0,t)},resiveOccupant:function(){for(var e=this,t=e.$el.find(".Occupant").find("input"),i=[],n=0;n<t.length;n++)i.push({id:n,name:t[n].value});D.set(null),D.set(i)},events:{"click #contactinfo li.fill-pic":function(){d.isLogin()?this.pushViewController(k,{pristine:!0,modalTitle:"选择联系人",modalUrl:Lizard.appBaseUrl+"contacts"}):this.pushViewController(P,{pristine:!0,modalTitle:"填写联系人信息",modalUrl:Lizard.appBaseUrl+"newcontact",modalData:{editonly:1}})},"click .E-changeInfo":function(){d.isLogin()?this.pushViewController(k,{pristine:!0,modalTitle:"选择联系人",modalUrl:Lizard.appBaseUrl+"contacts"}):this.pushViewController(P,{pristine:!0,modalTitle:"填写联系人信息",modalUrl:Lizard.appBaseUrl+"newcontact",modalData:{editonly:1}})},"click #notice span":function(){var e=this,t=e.$("#noticemask"),i=e.initNoticeTmpl();t.html(i),t.css("display","")},"click #noticemask":function(){var e=this,t=e.$("#noticemask");t.css("display","none")},"click #pricesum .shop-pay--b2croom":function(e){var t=this,i=$(e.currentTarget),n=function(){(d.isLogin()||d.isNonUser())&&t.verifyRoomTotalNums()};i.hasClass("bg-gray")||this.checkLogin(n)},"click #contactinfo li i.fil-cur":function(){$(".alert__layer--wrap").removeClass("hidden")},"click .E-closeBox":function(){$(".alert__layer--wrap").addClass("hidden")},"click #bedt p.detail-date-select span":function(e){var t=$(e.currentTarget),i=t.parent();return t.hasClass("pitch")?t.removeClass("pitch"):(i.find("span.pitch").removeClass("pitch"),void t.addClass("pitch"))},"click #morereq .checkbox-p p":function(e){var t="active",i=$(e.currentTarget),n=i.attr("data-type"),o=i.parent(),a=o.find("textarea"),r=i.hasClass(t);i[r?"removeClass":"addClass"](t),3==n&&(r?a.hide():a.show())},"click #editHd":function(){this.$eles.cartDiv.addClass("active")},"click #editFd":function(){this.$eles.cartDiv.removeClass("active")},"blur #idecode":function(e){this.TaxpayerIdentifier=e.currentTarget.value.replace(/\s/g,"")},"input #idecode":function(e){this.TaxpayerIdentifier=e.currentTarget.value.replace(/\s/g,"")},"click .j-login-btn":function(){this.goLogin()},"click .j-invoice":function(){this.jumpPage("invoice?resType="+this.getInvoiceResType()+"&bust="+Number(new Date))},"click .E-show":function(){$(".L-signupRemark").removeClass("warp"),$(".E-show").hide()},"click .E-goOccupant":function(){var e=this;e.isOccupant=1,this.gotoPage("b2Croom/occupant?num="+e.roomNum)}},goLogin:function(){"miniprogram"==window.__wxjs_environment?b("navigateTo",{url:"/pages/login/login?data="+encodeURIComponent(JSON.stringify({url:location.href}))}):d.memberLogin({isShowNonMemberLogin:!d.isNonUser(),domain:"//"+document.domain,param:"from="+encodeURIComponent(location.href)+"&backurl="+encodeURIComponent(location.href)})}});i.exports=z});